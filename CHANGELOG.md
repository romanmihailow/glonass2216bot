# Changelog

## [1.2.0] - 2025-08-13
### Added
- Полностью переписан main.py с асинхронным опросом Telegram-бота.
- Реализована обработка ошибок FloodWaitError и задержки между запросами.
- Автоматическая вставка пустого столбца в Google Sheets в колонку B перед каждым опросом.
- Запись даты/времени опроса в ячейку B1, а статусов машин — в B2…Bn.
- Поддержка запуска в Docker с конфигурацией через `.env` и `docker-compose.yml`.
- Логирование каждого запроса к боту с указанием номера запроса и задержки.
- Функция `col_number_to_letter` для работы с Google Sheets по буквам колонок.

### Fixed
- Исправлена ошибка при вставке столбцов через gspread.
- Исправлена обработка ответа бота и форматирование даты.
- Исправлено падение при ошибках Telegram API и отсутствии ответа.

### Changed
- Структура кода улучшена: логика вставки столбцов и опроса вынесена в отдельные функции.
- Dockerfile оптимизирован для сборки и работы контейнера.
- Обновлён `.env` для удобного хранения переменных окружения.

[1.1.0] - 2025-08-13
### Added
- Автоматическая вставка пустого столбца в Google Sheets в колонку B перед каждым опросом.
- Запись даты/времени опроса в ячейку B1, а статусов машин — в B2...Bn.
- Обработка ошибки FloodWaitError для Telegram API с ожиданием.
- Логирование каждого запроса к боту с задержками между ними.
- Поддержка запуска в Docker-контейнере с конфигурацией через `.env` и `docker-compose.yml`.

### Fixed
- Исправлена ошибка `TypeError: string indices must be integers` при вставке столбца через gspread.
- Убраны конфликты между форматом `Worksheet.batch_update` и `Spreadsheet.batch_update`.

### Changed
- Улучшена структура кода: вынесена логика вставки столбцов в отдельную функцию.
- Обновлён Dockerfile для оптимизации сборки образа.

[1.0.0] - 2025-08-12
- Реализован Python-сервис для опроса Telegram-бота @Glonass2216_bot по списку госномеров автомобилей.
- Отправка запросов по каждому госномеру и обработка ответов с датой и временем последней связи.
- Запись результатов в Google Sheets: каждый новый опрос создаёт новый столбец, сдвигая предыдущие вправо.
- В первом столбце — список госномеров. Во втором — время опроса и статусы "На связи"/"Нет связи"/"Нет ответа".
- Конфигурация и секреты вынесены в отдельный файл secrets/config.py.
- Поддержка файла Google service account ключа в формате JSON.
- Интервал опроса регулируется параметром POLL_INTERVAL_MINUTES.
- Инструкция по развёртыванию сервиса на Ubuntu.
- Настроен .gitignore для исключения папки secrets/ и сессий Telethon.
- Асинхронная реализация опроса с использованием Telethon и gspread.
